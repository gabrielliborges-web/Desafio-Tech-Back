/**
 * @swagger
 * tags:
 *   name: Movies
 *   description: Endpoints para gerenciamento de filmes
 */

/**
 * @swagger
 * /movie/create:
 *   post:
 *     summary: Cria um novo filme com upload de imagens e notifica칞칚o em tempo real
 *     description: >
 *       Cria um novo registro de filme, realiza upload das imagens (capa e p칪ster) para o AWS S3
 *       e, caso o filme seja **p칰blico** e esteja com status **PUBLISHED**, dispara automaticamente
 *       uma notifica칞칚o global em tempo real para todos os usu치rios conectados via **Socket.IO**.
 *       <br><br>
 *       游댒 **Notifica칞칫es em tempo real**
 *       <br>
 *       - Quando `visibility = PUBLIC` e `status = PUBLISHED`, o backend:
 *         - Registra uma entrada na tabela `Notification` no banco de dados;
 *         - Emite o evento `newMovie` com os detalhes da notifica칞칚o para todos os clientes conectados.
 *       <br><br>
 *       칄 necess치rio enviar o corpo da requisi칞칚o como **multipart/form-data** contendo:
 *       - Dados textuais do filme (campos obrigat칩rios e opcionais);
 *       - Arquivos `imageCover` e `imagePoster` (opcionais).
 *     tags: [Movies]
 *     security:
 *       - bearerAuth: []  # requer token JWT
 *     requestBody:
 *       required: true
 *       content:
 *         multipart/form-data:
 *           schema:
 *             type: object
 *             required:
 *               - title
 *               - tagline
 *             properties:
 *               title:
 *                 type: string
 *                 example: Interstellar
 *               tagline:
 *                 type: string
 *                 example: "Mankind was born on Earth. It was never meant to die here."
 *               description:
 *                 type: string
 *                 example: A group of explorers travel through a wormhole in space in an attempt to ensure humanity's survival.
 *               releaseDate:
 *                 type: string
 *                 format: date
 *                 example: 2014-11-07
 *               duration:
 *                 type: integer
 *                 example: 169
 *               indicativeRating:
 *                 type: integer
 *                 example: 12
 *               linkPreview:
 *                 type: string
 *                 example: https://www.youtube.com/watch?v=zSWdZVtXT7E
 *               language:
 *                 type: string
 *                 example: English
 *               country:
 *                 type: string
 *                 example: USA
 *               budget:
 *                 type: number
 *                 example: 165000000
 *               revenue:
 *                 type: number
 *                 example: 677471339
 *               actors:
 *                 type: array
 *                 items:
 *                   type: string
 *                 example: ["Matthew McConaughey", "Anne Hathaway", "Jessica Chastain"]
 *               producers:
 *                 type: array
 *                 items:
 *                   type: string
 *                 example: ["Emma Thomas", "Christopher Nolan"]
 *               director:
 *                 type: string
 *                 example: Christopher Nolan
 *               genres[0].name:
 *                 type: string
 *                 example: Sci-Fi
 *               genres[1].name:
 *                 type: string
 *                 example: Adventure
 *               status:
 *                 type: string
 *                 enum: [DRAFT, PUBLISHED]
 *                 example: PUBLISHED
 *               visibility:
 *                 type: string
 *                 enum: [PRIVATE, PUBLIC]
 *                 example: PUBLIC
 *               imageCover:
 *                 type: string
 *                 format: binary
 *                 description: Imagem de capa do filme (upload opcional)
 *               imagePoster:
 *                 type: string
 *                 format: binary
 *                 description: Imagem do p칪ster do filme (upload opcional)
 *     responses:
 *       201:
 *         description: Filme criado com sucesso e notifica칞칚o emitida (se aplic치vel)
 *         content:
 *           application/json:
 *             schema:
 *               type: object
 *               properties:
 *                 id:
 *                   type: integer
 *                   example: 15
 *                 title:
 *                   type: string
 *                   example: Interstellar
 *                 status:
 *                   type: string
 *                   example: PUBLISHED
 *                 visibility:
 *                   type: string
 *                   example: PUBLIC
 *                 imageCover:
 *                   type: string
 *                   example: https://bucket.s3.region.amazonaws.com/usuarios/1/movies/Interstellar/cover/uuid-cover.jpg
 *                 imagePoster:
 *                   type: string
 *                   example: https://bucket.s3.region.amazonaws.com/usuarios/1/movies/Interstellar/poster/uuid-poster.jpg
 *                 user:
 *                   type: object
 *                   properties:
 *                     id:
 *                       type: integer
 *                       example: 1
 *                     name:
 *                       type: string
 *                       example: Gabrielli Borges
 *                     email:
 *                       type: string
 *                       example: gabi@example.com
 *       400:
 *         description: Erro de valida칞칚o ou dados inv치lidos
 *       401:
 *         description: Usu치rio n칚o autenticado
 *       500:
 *         description: Erro interno ao criar filme
 */

/**
 * @swagger
 * /movie/{id}:
 *   put:
 *     summary: Atualiza um filme existente (com reenvio de notifica칞칚o, se aplic치vel)
 *     description: >
 *       Atualiza os dados de um filme existente, permitindo tamb칠m substituir as imagens (capa e p칪ster)
 *       e reagendar notifica칞칫es autom치ticas.
 *       <br><br>
 *       - Apenas o criador do filme pode atualiz치-lo.
 *       - Imagens antigas s칚o removidas automaticamente do S3 se novas forem enviadas.
 *       - Caso o filme atualizado tenha `status = PUBLISHED` e `visibility = PUBLIC`,
 *         uma nova notifica칞칚o ser치 registrada e enviada via **Socket.IO**.
 *     tags: [Movies]
 *     security:
 *       - bearerAuth: []
 *     parameters:
 *       - in: path
 *         name: id
 *         required: true
 *         description: ID do filme a ser atualizado
 *         schema:
 *           type: integer
 *         example: 1
 *     requestBody:
 *       required: true
 *       content:
 *         multipart/form-data:
 *           schema:
 *             $ref: '#/components/schemas/MovieUpdate'
 *     responses:
 *       200:
 *         description: Filme atualizado com sucesso
 *       400:
 *         description: Dados inv치lidos
 *       403:
 *         description: Usu치rio n칚o tem permiss칚o para editar este filme
 *       404:
 *         description: Filme n칚o encontrado
 */

/**
 * @swagger
 * /movie/list:
 *   get:
 *     summary: Lista todos os filmes com pagina칞칚o, filtros e regras de visibilidade
 *     description: >
 *       Retorna uma lista de filmes com base nos filtros aplicados.
 *       - Se **status** n칚o for informado, retornar치 apenas filmes **PUBLISHED**.
 *       - Se **status = DRAFT**, retornar치 apenas filmes criados pelo usu치rio autenticado.
 *       - 칄 necess치rio um token v치lido (Bearer) para acesso.
 *     tags: [Movies]
 *     security:
 *       - bearerAuth: []
 *     parameters:
 *       - in: query
 *         name: page
 *         description: "P치gina atual da listagem."
 *         schema:
 *           type: integer
 *           default: 1
 *         example: 1
 *       - in: query
 *         name: limit
 *         description: "Quantidade m치xima de filmes por p치gina."
 *         schema:
 *           type: integer
 *           default: 10
 *         example: 10
 *       - in: query
 *         name: search
 *         description: "Busca por t칤tulo, t칤tulo original ou tagline."
 *         schema:
 *           type: string
 *         example: "Inception"
 *       - in: query
 *         name: status
 *         description: "Filtra filmes por status de publica칞칚o (DRAFT ou PUBLISHED)."
 *         schema:
 *           type: string
 *           enum: [DRAFT, PUBLISHED]
 *         example: "PUBLISHED"
 *       - in: query
 *         name: visibility
 *         description: "Filtra filmes por visibilidade (PUBLIC ou PRIVATE)."
 *         schema:
 *           type: string
 *           enum: [PUBLIC, PRIVATE]
 *         example: "PUBLIC"
 *       - in: query
 *         name: genre
 *         description: "Filtra filmes pelo nome do g칡nero."
 *         schema:
 *           type: string
 *         example: "Action"
 *       - in: query
 *         name: orderBy
 *         description: "Campo de ordena칞칚o (exemplo: title, releaseDate, ratingAvg, createdAt)."
 *         schema:
 *           type: string
 *           enum: [title, releaseDate, ratingAvg, createdAt]
 *         example: "createdAt"
 *       - in: query
 *         name: order
 *         description: "Dire칞칚o da ordena칞칚o (ascendente ou descendente)."
 *         schema:
 *           type: string
 *           enum: [asc, desc]
 *         example: "desc"
 *     responses:
 *       200:
 *         description: "Lista de filmes retornada com sucesso."
 *         content:
 *           application/json:
 *             schema:
 *               type: object
 *               properties:
 *                 data:
 *                   type: array
 *                   items:
 *                     $ref: '#/components/schemas/Movie'
 *                 meta:
 *                   type: object
 *                   properties:
 *                     total:
 *                       type: integer
 *                       example: 42
 *                     page:
 *                       type: integer
 *                       example: 1
 *                     limit:
 *                       type: integer
 *                       example: 10
 *                     totalPages:
 *                       type: integer
 *                       example: 5
 *       400:
 *         description: "Par칙metros de busca inv치lidos ou erro de valida칞칚o."
 *         content:
 *           application/json:
 *             schema:
 *               type: object
 *               properties:
 *                 error:
 *                   type: string
 *                   example: "Erro ao carregar lista de filmes."
 *       401:
 *         description: "Token inv치lido ou ausente."
 *         content:
 *           application/json:
 *             schema:
 *               type: object
 *               properties:
 *                 error:
 *                   type: string
 *                   example: "Token n칚o fornecido."
 */

/**
 * @swagger
 * /movie/{id}:
 *   get:
 *     summary: Obt칠m os detalhes de um filme pelo ID
 *     description: >
 *       Retorna as informa칞칫es completas de um filme, incluindo g칡neros, avalia칞칫es, coment치rios e autor.
 *       - Se o filme estiver com **status = PUBLISHED**, qualquer usu치rio autenticado pode visualiz치-lo.
 *       - Se o filme estiver com **status = DRAFT**, apenas o criador do filme poder치 acess치-lo.
 *       - 칄 necess치rio um token Bearer v치lido para realizar a requisi칞칚o.
 *     tags: [Movies]
 *     security:
 *       - bearerAuth: []
 *     parameters:
 *       - in: path
 *         name: id
 *         required: true
 *         description: "ID num칠rico do filme a ser buscado."
 *         schema:
 *           type: integer
 *         example: 1
 *     responses:
 *       200:
 *         description: "Filme encontrado com sucesso."
 *         content:
 *           application/json:
 *             schema:
 *               $ref: '#/components/schemas/Movie'
 *       400:
 *         description: "ID inv치lido ou erro na requisi칞칚o."
 *         content:
 *           application/json:
 *             schema:
 *               type: object
 *               properties:
 *                 error:
 *                   type: string
 *                   example: "ID inv치lido."
 *       403:
 *         description: "Acesso negado. O filme 칠 um rascunho privado de outro usu치rio."
 *         content:
 *           application/json:
 *             schema:
 *               type: object
 *               properties:
 *                 error:
 *                   type: string
 *                   example: "Acesso negado. Este filme 칠 um rascunho privado."
 *       404:
 *         description: "Filme n칚o encontrado."
 *         content:
 *           application/json:
 *             schema:
 *               type: object
 *               properties:
 *                 error:
 *                   type: string
 *                   example: "Filme n칚o encontrado."
 */

/**
 * @swagger
 * /movie/{id}:
 *   delete:
 *     summary: Remove um filme existente (somente o autor pode deletar)
 *     description: >
 *       Permite a exclus칚o de um filme pelo ID.
 *       - Antes da exclus칚o, remove v칤nculos em `MovieGenre` para evitar erro de chave estrangeira.
 *       - Apenas o criador do filme pode delet치-lo.
 *     tags: [Movies]
 *     security:
 *       - bearerAuth: []
 *     parameters:
 *       - in: path
 *         name: id
 *         required: true
 *         description: ID do filme a ser deletado
 *         schema:
 *           type: integer
 *         example: 1
 *     responses:
 *       200:
 *         description: Filme removido com sucesso
 *       403:
 *         description: Usu치rio n칚o tem permiss칚o para deletar este filme
 *       404:
 *         description: Filme n칚o encontrado
 */

/**
 * @swagger
 * components:
 *   schemas:
 *     MovieCreate:
 *       type: object
 *       required:
 *         - title
 *         - tagline
 *       properties:
 *         title:
 *           type: string
 *           example: Inception
 *         tagline:
 *           type: string
 *           example: Your mind is the scene of the crime
 *         description:
 *           type: string
 *           example: A skilled thief who steals corporate secrets through dream-sharing technology.
 *         releaseDate:
 *           type: string
 *           format: date
 *           example: 2010-07-16
 *         duration:
 *           type: integer
 *           example: 148
 *         indicativeRating:
 *           type: integer
 *           example: 14
 *         imageCover:
 *           type: string
 *           format: binary
 *           description: Arquivo de imagem da capa (upload)
 *         imagePoster:
 *           type: string
 *           format: binary
 *           description: Arquivo de imagem do p칪ster (upload)
 *         linkPreview:
 *           type: string
 *           example: https://www.youtube.com/watch?v=YoHD9XEInc0
 *         actors:
 *           type: array
 *           items:
 *             type: string
 *           example: ["Leonardo DiCaprio", "Joseph Gordon-Levitt"]
 *         director:
 *           type: string
 *           example: Christopher Nolan
 *         producers:
 *           type: array
 *           items:
 *             type: string
 *           example: ["Emma Thomas", "Christopher Nolan"]
 *         language:
 *           type: string
 *           example: English
 *         country:
 *           type: string
 *           example: USA
 *         budget:
 *           type: number
 *           example: 160000000
 *         revenue:
 *           type: number
 *           example: 825532764
 *         profit:
 *           type: number
 *           example: 100000000
 *         ratingAvg:
 *           type: number
 *           example: 85
 *         status:
 *           type: string
 *           enum: [DRAFT, PUBLISHED]
 *           example: PUBLISHED
 *         visibility:
 *           type: string
 *           enum: [PUBLIC, PRIVATE]
 *           example: PUBLIC
 *         genres:
 *           type: array
 *           items:
 *             type: object
 *             properties:
 *               name:
 *                 type: string
 *                 example: Action
 *
 *     MovieUpdate:
 *       type: object
 *       description: Campos opcionais para atualiza칞칚o parcial de um filme
 *       properties:
 *         title:
 *           type: string
 *           example: Inception (Director's Cut)
 *         tagline:
 *           type: string
 *           example: The dream continues
 *         description:
 *           type: string
 *         duration:
 *           type: integer
 *           example: 150
 *         imageCover:
 *           type: string
 *           format: binary
 *           description: Nova imagem de capa (substitui a anterior)
 *         imagePoster:
 *           type: string
 *           format: binary
 *           description: Novo p칪ster (substitui o anterior)
 *         status:
 *           type: string
 *           enum: [DRAFT, PUBLISHED]
 *         visibility:
 *           type: string
 *           enum: [PUBLIC, PRIVATE]
 *
 *   securitySchemes:
 *     bearerAuth:
 *       type: http
 *       scheme: bearer
 *       bearerFormat: JWT
 */

/**
 * @swagger
 * tags:
 *   name: Movies
 *   description: Endpoints relacionados aos filmes
 */

/**
 * @swagger
 * /movies:
 *   get:
 *     summary: Lista todos os filmes p칰blicos e privados do usu치rio logado
 *     description: Retorna filmes p칰blicos e os privados pertencentes ao usu치rio logado, com suporte a filtros e pagina칞칚o.
 *     tags: [Movies]
 *     security:
 *       - bearerAuth: []
 *     parameters:
 *       - in: query
 *         name: search
 *         schema:
 *           type: string
 *         description: Texto para busca (t칤tulo, descri칞칚o, diretor etc.)
 *       - in: query
 *         name: genre
 *         schema:
 *           type: string
 *         description: Filtro por g칡nero
 *       - in: query
 *         name: visibility
 *         schema:
 *           type: string
 *           enum: [PUBLIC, PRIVATE]
 *       - in: query
 *         name: page
 *         schema:
 *           type: integer
 *         description: P치gina atual
 *       - in: query
 *         name: limit
 *         schema:
 *           type: integer
 *         description: Limite de registros por p치gina
 *     responses:
 *       200:
 *         description: Lista de filmes retornada com sucesso.
 *         content:
 *           application/json:
 *             schema:
 *               type: object
 *               properties:
 *                 data:
 *                   type: array
 *                   items:
 *                     $ref: '#/components/schemas/Movie'
 *                 meta:
 *                   type: object
 *                   properties:
 *                     total:
 *                       type: integer
 *                     page:
 *                       type: integer
 *                     limit:
 *                       type: integer
 *                     totalPages:
 *                       type: integer
 *       401:
 *         description: Token inv치lido ou ausente.
 *       500:
 *         description: Erro interno do servidor.
 */

/**
 * @swagger
 * /movies/user:
 *   get:
 *     summary: Lista todos os filmes do usu치rio logado
 *     description: Retorna apenas os filmes criados pelo usu치rio autenticado, com suporte a filtros e pagina칞칚o.
 *     tags: [Movies]
 *     security:
 *       - bearerAuth: []
 *     parameters:
 *       - in: query
 *         name: search
 *         schema:
 *           type: string
 *         description: Texto para busca (t칤tulo, descri칞칚o etc.)
 *       - in: query
 *         name: status
 *         schema:
 *           type: string
 *           enum: [DRAFT, PUBLISHED]
 *         description: Filtro por status do filme
 *       - in: query
 *         name: visibility
 *         schema:
 *           type: string
 *           enum: [PUBLIC, PRIVATE]
 *         description: Filtro por visibilidade
 *       - in: query
 *         name: page
 *         schema:
 *           type: integer
 *         description: P치gina atual
 *       - in: query
 *         name: limit
 *         schema:
 *           type: integer
 *         description: Limite de registros por p치gina
 *     responses:
 *       200:
 *         description: Lista de filmes do usu치rio retornada com sucesso.
 *         content:
 *           application/json:
 *             schema:
 *               type: object
 *               properties:
 *                 data:
 *                   type: array
 *                   items:
 *                     $ref: '#/components/schemas/Movie'
 *                 meta:
 *                   type: object
 *                   properties:
 *                     total:
 *                       type: integer
 *                     page:
 *                       type: integer
 *                     limit:
 *                       type: integer
 *                     totalPages:
 *                       type: integer
 *       401:
 *         description: Token inv치lido ou ausente.
 *       500:
 *         description: Erro interno do servidor.
 */

/**
 * @swagger
 * /movies/{id}/status:
 *   patch:
 *     summary: Atualiza o status de um filme (rascunho ou publicado)
 *     description: Permite alternar o status do filme entre **DRAFT** e **PUBLISHED**.
 *     tags: [Movies]
 *     security:
 *       - bearerAuth: []
 *     parameters:
 *       - in: path
 *         name: id
 *         schema:
 *           type: integer
 *         required: true
 *         description: ID do filme a ser atualizado.
 *     requestBody:
 *       required: true
 *       content:
 *         application/json:
 *           schema:
 *             type: object
 *             properties:
 *               status:
 *                 type: string
 *                 enum: [DRAFT, PUBLISHED]
 *                 example: PUBLISHED
 *     responses:
 *       200:
 *         description: Status atualizado com sucesso.
 *         content:
 *           application/json:
 *             schema:
 *               type: object
 *               properties:
 *                 message:
 *                   type: string
 *                   example: "Status do filme atualizado para PUBLISHED."
 *                 data:
 *                   type: object
 *                   properties:
 *                     id:
 *                       type: integer
 *                     title:
 *                       type: string
 *                     status:
 *                       type: string
 *                     updatedAt:
 *                       type: string
 *                       format: date-time
 *       401:
 *         description: Token inv치lido ou ausente.
 *       404:
 *         description: Filme n칚o encontrado.
 *       403:
 *         description: Usu치rio n칚o tem permiss칚o para editar o filme.
 *       500:
 *         description: Erro interno do servidor.
 */

/**
 * @swagger
 * components:
 *   schemas:
 *     Movie:
 *       type: object
 *       properties:
 *         id:
 *           type: integer
 *         title:
 *           type: string
 *         tagline:
 *           type: string
 *         description:
 *           type: string
 *         releaseDate:
 *           type: string
 *           format: date
 *         status:
 *           type: string
 *           enum: [DRAFT, PUBLISHED]
 *         visibility:
 *           type: string
 *           enum: [PUBLIC, PRIVATE]
 *         imageCover:
 *           type: string
 *         imagePoster:
 *           type: string
 *         createdAt:
 *           type: string
 *           format: date-time
 *         updatedAt:
 *           type: string
 *           format: date-time
 *         user:
 *           type: object
 *           properties:
 *             id:
 *               type: integer
 *             name:
 *               type: string
 *         genres:
 *           type: array
 *           items:
 *             type: object
 *             properties:
 *               genre:
 *                 type: object
 *                 properties:
 *                   name:
 *                     type: string
 */
